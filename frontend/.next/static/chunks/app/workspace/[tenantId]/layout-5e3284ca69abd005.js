(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1022],{36039:function(e,t,a){Promise.resolve().then(a.bind(a,40229))},98420:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(39763).Z)("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]])},40229:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return _}});var s=a(57437),r=a(2265),n=a(99376),l=a(27648),o=a(83464),i=a(12381),d=a(96246),c=a(69174),u=a(49027),f=a(90535),m=a(32489),x=a(93448);let h=u.fC;u.xz,u.x8;let p=u.h_,g=(0,f.j)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),y=r.forwardRef((e,t)=>{let{side:a="right",className:r,children:n,...l}=e;return(0,s.jsxs)(p,{children:[(0,s.jsx)(N,{}),(0,s.jsxs)(u.VY,{ref:t,className:(0,x.cn)(g({side:a}),r),...l,children:[n,(0,s.jsxs)(u.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,s.jsx)(m.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});y.displayName=u.VY.displayName;let N=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(u.aV,{className:(0,x.cn)("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r,ref:t})});N.displayName=u.aV.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(u.Dx,{ref:t,className:(0,x.cn)("text-lg font-semibold text-foreground",a),...r})}).displayName=u.Dx.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(u.dk,{ref:t,className:(0,x.cn)("text-sm text-muted-foreground",a),...r})}).displayName=u.dk.displayName;var b=a(32060),w=a(31593),j=a(14362),v=a(60621),k=a(14438),C=a(25466),Z=a(56475),E=a(95805),z=a(98420),R=a(98728),S=a(58293),A=a(47692),_=e=>{var t,a;let{children:u}=e,[f,m]=(0,r.useState)(!1),[x,p]=(0,r.useState)(null),{user:g,logout:N}=(0,j.a)(),_=(0,n.useRouter)(),T=(0,n.useParams)(),V=(null==T?void 0:T.tenantId)?T.tenantId:"",U=(0,r.useCallback)(async()=>{try{let e=new v.S().getToken();if(!e){console.error("No authentication token found"),_.push("/");return}let t=await o.Z.get("http://localhost:8000/api/tenants/".concat(V),{headers:{Authorization:"Bearer ".concat(e)}});p(t.data)}catch(e){console.error("Error fetching tenant info:",e),_.push("/")}},[V,_]);(0,r.useEffect)(()=>{U()},[U]);let F=async()=>{await N()},M=(0,s.jsxs)("div",{className:"h-full bg-white border-r border-gray-200 flex flex-col",children:[(0,s.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)(d.qE,{className:"h-10 w-10 bg-gradient-primary",children:(0,s.jsx)(d.Q5,{className:"bg-gradient-primary text-white font-semibold",children:(null==x?void 0:null===(t=x.name)||void 0===t?void 0:t.charAt(0).toUpperCase())||"W"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-gray-900 truncate",children:(null==x?void 0:x.name)||"Workspace"}),(0,s.jsx)(c.C,{variant:"secondary",className:"mt-1 text-xs",children:(null==x?void 0:x.user_role)||"member"})]})]})}),(0,s.jsxs)("nav",{className:"flex-1 p-4 space-y-2",children:[(0,s.jsxs)(l.default,{href:"/workspace/".concat(V),className:"flex items-center space-x-3 px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors",children:[(0,s.jsx)(C.Z,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:"Dashboard"})]}),(0,s.jsxs)(l.default,{href:"/projects",className:"flex items-center space-x-3 px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors",children:[(0,s.jsx)(Z.Z,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:"Projects"})]}),(0,s.jsxs)(l.default,{href:"/team",className:"flex items-center space-x-3 px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors",children:[(0,s.jsx)(E.Z,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:"Team"})]}),(0,s.jsxs)(l.default,{href:"/crm/customers",className:"flex items-center space-x-3 px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors",children:[(0,s.jsx)(E.Z,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:"Customers"})]}),(null==g?void 0:g.userRole)==="super_admin"&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(w.Z,{className:"my-4"}),(0,s.jsxs)(l.default,{href:"/users",className:"flex items-center space-x-3 px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors",children:[(0,s.jsx)(E.Z,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:"Users"})]}),(0,s.jsxs)(l.default,{href:"/pages/tenants",className:"flex items-center space-x-3 px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors",children:[(0,s.jsx)(z.Z,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:"Tenants"})]})]}),(0,s.jsx)(w.Z,{className:"my-4"}),(0,s.jsxs)(l.default,{href:"/workspace/".concat(V,"/settings"),className:"flex items-center space-x-3 px-3 py-2 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors",children:[(0,s.jsx)(R.Z,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:"Settings"})]})]})]});return(0,s.jsxs)("div",{className:"h-screen flex bg-gray-50",children:[(0,s.jsx)("div",{className:"hidden lg:block w-64 flex-shrink-0",children:M}),(0,s.jsx)(h,{open:f,onOpenChange:m,children:(0,s.jsx)(y,{side:"left",className:"p-0 w-64",children:M})}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col min-w-0",children:[(0,s.jsx)("header",{className:"bg-white border-b border-gray-200 px-6 py-4 flex-shrink-0",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)(i.z,{variant:"ghost",size:"sm",className:"lg:hidden",onClick:()=>m(!0),children:(0,s.jsx)(S.Z,{className:"h-5 w-5"})}),(0,s.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:(null==x?void 0:x.name)||"Workspace"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)(i.z,{variant:"outline",onClick:()=>{_.push("/")},className:"hidden sm:flex items-center space-x-2",children:[(0,s.jsx)(z.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:"Switch Workspace"})]}),(0,s.jsxs)(b.h_,{children:[(0,s.jsx)(b.$F,{asChild:!0,children:(0,s.jsxs)(i.z,{variant:"ghost",className:"flex items-center space-x-2 px-3",children:[(0,s.jsx)(d.qE,{className:"h-8 w-8",children:(0,s.jsx)(d.Q5,{className:"bg-gradient-primary text-white text-sm",children:(null==g?void 0:null===(a=g.userName)||void 0===a?void 0:a.charAt(0).toUpperCase())||"U"})}),(0,s.jsx)("span",{className:"hidden sm:block text-sm font-medium text-gray-700",children:(null==g?void 0:g.userName)||"User"})]})}),(0,s.jsx)(b.AW,{align:"end",className:"w-48",children:(0,s.jsxs)(b.Xi,{onClick:F,className:"text-red-600",children:[(0,s.jsx)(A.Z,{className:"mr-2 h-4 w-4"}),"Logout"]})})]})]})]})}),(0,s.jsx)("main",{className:"flex-1 overflow-auto p-6",children:u})]}),(0,s.jsx)(k.x7,{})]})}},96246:function(e,t,a){"use strict";a.d(t,{F$:function(){return i},Q5:function(){return d},qE:function(){return o}});var s=a(57437),r=a(2265),n=a(61146),l=a(93448);let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.fC,{ref:t,className:(0,l.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...r})});o.displayName=n.fC.displayName;let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.Ee,{ref:t,className:(0,l.cn)("aspect-square h-full w-full",a),...r})});i.displayName=n.Ee.displayName;let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.NY,{ref:t,className:(0,l.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...r})});d.displayName=n.NY.displayName},69174:function(e,t,a){"use strict";a.d(t,{C:function(){return o}});var s=a(57437);a(2265);var r=a(90535),n=a(93448);let l=(0,r.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",success:"border-transparent bg-green-100 text-green-800 hover:bg-green-200",warning:"border-transparent bg-yellow-100 text-yellow-800 hover:bg-yellow-200",info:"border-transparent bg-blue-100 text-blue-800 hover:bg-blue-200",gradient:"border-transparent bg-gradient-to-r from-blue-600 to-purple-600 text-white",glass:"border-white/30 bg-white/20 backdrop-blur-sm text-gray-800"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:a,...r}=e;return(0,s.jsx)("div",{className:(0,n.cn)(l({variant:a}),t),...r})}},32060:function(e,t,a){"use strict";a.d(t,{$F:function(){return u},AW:function(){return f},Ju:function(){return x},VD:function(){return h},Xi:function(){return m},h_:function(){return c}});var s=a(57437),r=a(2265),n=a(70085),l=a(10407),o=a(30401),i=a(40519),d=a(93448);let c=n.fC,u=n.xz;n.ZA,n.Uv,n.Tr,n.Ee,r.forwardRef((e,t)=>{let{className:a,inset:r,children:o,...i}=e;return(0,s.jsxs)(n.fF,{ref:t,className:(0,d.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",r&&"pl-8",a),...i,children:[o,(0,s.jsx)(l.Z,{className:"ml-auto h-4 w-4"})]})}).displayName=n.fF.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.tu,{ref:t,className:(0,d.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...r})}).displayName=n.tu.displayName;let f=r.forwardRef((e,t)=>{let{className:a,sideOffset:r=4,...l}=e;return(0,s.jsx)(n.Uv,{children:(0,s.jsx)(n.VY,{ref:t,sideOffset:r,className:(0,d.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...l})})});f.displayName=n.VY.displayName;let m=r.forwardRef((e,t)=>{let{className:a,inset:r,...l}=e;return(0,s.jsx)(n.ck,{ref:t,className:(0,d.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r&&"pl-8",a),...l})});m.displayName=n.ck.displayName,r.forwardRef((e,t)=>{let{className:a,children:r,checked:l,...i}=e;return(0,s.jsxs)(n.oC,{ref:t,className:(0,d.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:l,...i,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(n.wU,{children:(0,s.jsx)(o.Z,{className:"h-4 w-4"})})}),r]})}).displayName=n.oC.displayName,r.forwardRef((e,t)=>{let{className:a,children:r,...l}=e;return(0,s.jsxs)(n.Rk,{ref:t,className:(0,d.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...l,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(n.wU,{children:(0,s.jsx)(i.Z,{className:"h-2 w-2 fill-current"})})}),r]})}).displayName=n.Rk.displayName;let x=r.forwardRef((e,t)=>{let{className:a,inset:r,...l}=e;return(0,s.jsx)(n.__,{ref:t,className:(0,d.cn)("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",a),...l})});x.displayName=n.__.displayName;let h=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.Z0,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",a),...r})});h.displayName=n.Z0.displayName},31593:function(e,t,a){"use strict";a.d(t,{Z:function(){return o}});var s=a(57437),r=a(2265),n=a(55156),l=a(93448);let o=r.forwardRef((e,t)=>{let{className:a,orientation:r="horizontal",decorative:o=!0,...i}=e;return(0,s.jsx)(n.f,{ref:t,decorative:o,orientation:r,className:(0,l.cn)("shrink-0 bg-border","horizontal"===r?"h-[1px] w-full":"h-full w-[1px]",a),...i})});o.displayName=n.f.displayName},14362:function(e,t,a){"use strict";a.d(t,{AuthProvider:function(){return i},a:function(){return d}});var s=a(57437),r=a(2265),n=a(89441),l=a(60621);let o=(0,r.createContext)(void 0);function i(e){let{children:t}=e,[a,i]=(0,r.useState)(null),[d,c]=(0,r.useState)(!0),[u,f]=(0,r.useState)([]),[m,x]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{try{let e=new l.S;if(e.isSessionValid()){if(e.isTokenExpired()&&!await e.refreshAccessToken()){e.clearSession(),i(null),c(!1);return}let t=e.getSession();if(t&&t.token&&t.user){i(t.user);let e=n.Ew.getUserTenants();if(e.length>0){f(e);let t=n.Ew.getCurrentTenant();t?x(t):(x(e[0]),n.Ew.setTenantId(e[0].id))}}else e.clearSession(),i(null)}else e.clearSession(),i(null)}catch(e){console.error("AuthContext - Auth initialization error:",e),new l.S().clearSession(),i(null)}finally{c(!1)}})()},[]);let h=async e=>{try{c(!0);let t=await n.Ew.login(e);if(t.success&&t.user){i(t.user);let e=n.Ew.getUserTenants();if(e.length>0){f(e);let t=n.Ew.getCurrentTenant();t&&x(t)}return!0}return!1}catch(e){return console.error("AuthContext - Login failed:",e),!1}finally{c(!1)}},p=async()=>{try{await n.Ew.logout()}catch(e){console.error("AuthContext - Logout error:",e)}finally{let e=new l.S;i(null),f([]),x(null),e.clearSession(),n.Ew.setTenantId(null),window.location.href="/login"}},g=async e=>{try{let t=await n.Ew.switchTenant(e);return x(t),!0}catch(e){return console.error("AuthContext - Failed to switch tenant:",e),!1}};return(0,s.jsx)(o.Provider,{value:{user:a,loading:d,isAuthenticated:!!a,tenants:u,currentTenant:m,login:h,logout:p,switchTenant:g},children:t})}function d(){let e=(0,r.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},55156:function(e,t,a){"use strict";a.d(t,{f:function(){return d}});var s=a(2265),r=a(66840),n=a(57437),l="horizontal",o=["horizontal","vertical"],i=s.forwardRef((e,t)=>{let{decorative:a,orientation:s=l,...i}=e,d=o.includes(s)?s:l;return(0,n.jsx)(r.WV.div,{"data-orientation":d,...a?{role:"none"}:{"aria-orientation":"vertical"===d?d:void 0,role:"separator"},...i,ref:t})});i.displayName="Separator";var d=i}},function(e){e.O(0,[7846,7648,4259,2709,5202,9515,2971,2117,1744],function(){return e(e.s=36039)}),_N_E=e.O()}]);